function swms_scan_now(scanurl,resultid)
{  		
		jQuery("#scanner_"+resultid).css('display','inline-block');
		jQuery("#swms_report_"+resultid).css('display','none');
		jQuery("a.scan-btn").css('pointer-events','none');
		jQuery("a.delete-btn").css('pointer-events','none');
		
		quttera_scan = function(){
			jQuery.post(
			ajaxurl, 
			{
				'action': 'swms_get_scan_results_from_quttera',
				'data':   scanurl
			}, 
			function(response){ 
				var quttera_response = JSON.parse(response);
				var quttera_error = quttera_response.error;
				var quttera_errorstr = quttera_response.errorstr; 
				if((quttera_error == "200" && quttera_errorstr =="success") || (quttera_error == "200" && quttera_errorstr =="operation already done")){
					jQuery("#swms_submit_message").html("").css('display', 'block');
					jQuery("#swms_submit_message").html("<b>URL was successfully submitted for scanning, check your status now.</b>").fadeOut(20000);
					jQuery("#scanner_"+resultid).css('display','none');
					jQuery("a.scan-btn").css('pointer-events','visible');
				    jQuery("a.delete-btn").css('pointer-events','visible'); 
					var swms_onclick = "swms_status_check(\'"+scanurl+"\','"+resultid+"');"
					jQuery("#swms_table tr td#swms_result_"+resultid+" span").html('<a id="swms_status" href="javascript:void();" onclick="'+swms_onclick+'" class="button sa-red-btn sa-status-btn">Check Status</a>');
				}
				
				}
			);
		
	   }
	   quttera_scan();
}
function swms_status_check(scanurl,resultid){	
	jQuery("#swms-submit-message-status").html("").css('display', 'block');
	jQuery("#swms-submit-message-status").html("<b>Our Deep Scanner Can Take Up To 15 Minutes Please Wait For the Scan To Complete</b>").fadeOut(20000);
	quttera_status = function(){
		jQuery("#scannerc_"+resultid).css('display','inline-block'); 
		jQuery("a.scan-btn").css('pointer-events','none');
		jQuery("a.delete-btn").css('pointer-events','none');
		jQuery("a.sa-report-btn").css('pointer-events','none');
		jQuery("a.sa-status-btn").css('pointer-events','none');
		jQuery("#swms_submit_message").html("").css('display', 'block');
			jQuery.post(
			ajaxurl, 
			{
				'action': 'swms_get_status_results_from_quttera',
				'data':   scanurl
			}, 
			function(response){
				//alert(response);
				var quttera_status_response = JSON.parse(response);
				var quttera_status_scanner_status = quttera_status_response.status.state;
				if(quttera_status_scanner_status == "DONE"){ 
					jQuery.post(
					ajaxurl, 
					{
						'action': 'swms_get_status_report_from_quttera',
						'data':   scanurl
					}, 
					function(response){ 
						jQuery("#swms_submit_message").html("").css('display', 'block');
						jQuery("#swms_submit_message").html("<b>Your report is ready, please click report button and get your report</b>").fadeOut(20000);
						jQuery.post(
						ajaxurl, 
						{
							'action': 'swms_get_admin_url',
							'data':   scanurl
						}, 
						function(response){  
							var swms_source = response;
							jQuery("#scannerc_"+resultid).css('display','none');
							jQuery("a.scan-btn").css('pointer-events','visible');
							jQuery("a.delete-btn").css('pointer-events','visible');
							jQuery("a.sa-report-btn").css('pointer-events','visible');
							jQuery("a.sa-status-btn").css('pointer-events','visible');
							jQuery("#swms_table tr td#swms_result_"+resultid+" span").html('<a id="swms_report" href="'+swms_source+'" class="button sa-red-btn">Report</a>');
							}
						);
						
					});
				}else if(quttera_status_scanner_status == "SCAN"){ 
					jQuery("#swms_submit_message").html("<b>Our Deep Scanner Can Take Up To 15 Minutes Please Wait For the Scan To Complete</b>").fadeOut(4000);
					quttera_status();
				}else if(quttera_status_scanner_status == "DOWNLOAD"){ 
					jQuery("#swms_submit_message").html("<b>Our Deep Scanner Can Take Up To 15 Minutes Please Wait For the Scan To Complete</b>").fadeOut(4000);
					quttera_status();
				}else if(quttera_status_scanner_status == "NEW"){ 
					jQuery("#swms_submit_message").html("<b>Our Deep Scanner Can Take Up To 15 Minutes Please Wait For the Scan To Complete</b>").fadeOut(4000);
					quttera_status();
				}else{ 
					jQuery("#swms_submit_message").html("<b>Our Deep Scanner Can Take Up To 15 Minutes Please Wait For the Scan To Complete</b>").fadeOut(4000);
					quttera_status();
				}
				
				
			}
			);
		
	   }
	   quttera_status();
}
function swms_delete_now(scanurl,resultid)
{
	if (confirm('Are you sure want to delete?')) {
		jQuery("#deleter_"+resultid).css('display','inline-block');
		jQuery("a.delete-btn").css('pointer-events','none');
		jQuery.post(
		ajaxurl, 
		{
			'action': 'swms_delete_scan_url',
			'data':   scanurl
		}, 
		function(response){
			
			if(response == "SUCCESS")
			{
				jQuery("#deleter_"+resultid).css('display','none');
				location.reload();
			}
		}
		);
	}
}